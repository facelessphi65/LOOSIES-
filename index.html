<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LOOSIES!</title>
<style>
  body {
    margin: 0;
    padding: 0;
    height: 100vh;
    width: 100vw;
    display: flex;
    justify-content: center;
    align-items: center;
    background:#ababab url('loosies.jpg') no-repeat center center fixed;
    background-size: contain; 
    font-family: sans-serif;
  }
  .container {
    text-align: center;
    padding: 1rem;
    background-color: #222;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.4);
    animation: float 2s ease-in-out infinite;
    margin-top: 180px;
    transform: translateY(30px);
    width: 80vw;
    max-width: 500px;
  }
  @keyframes float { 0% { transform: translateY(30px); } 50% { transform: translateY(20px); } 100% { transform: translateY(30px); } }
  h1 { color: white; font-size: 2rem; margin: 0; text-align: center; }
  .controls { margin-top: 1rem; }
  button {
    padding: 0.5rem 1rem;
    margin: 0 0.5rem;
    background-color: #111;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1rem;
  }
  button:hover { background-color: #444; }
  #trackTitle { margin-top: 1rem; color: white; font-size: 1.1rem; }
</style>
</head>
<body>
<div class="container">
  <h1>LOOSIES! üíÄ</h1>
  <div class="controls">
    <button id="startBtn">‚ñ∂Ô∏è Start Listening</button>
    <div id="navControls" style="display:none;">
      <button id="prevBtn">‚èÆÔ∏è Prev</button>
      <button id="nextBtn">Next ‚è≠Ô∏è</button>
    </div>
  </div>
  <div id="trackTitle"></div>
</div>

<script>
const tracks = [
  { src: "music/track1.ogg", title: "PRUDENTIAL!" },
  { src: "music/track2.ogg", title: "DUMBO!" },
  { src: "music/track3.ogg", title: "ANTIDEPRESSANTS!" },
  { src: "music/track4.ogg", title: "iNFORMANT! interlude" },
  { src: "music/track5.ogg", title: "nao falar!" }
];

let currentTrack = 0;
let currentAudio = new Audio();
let nextAudio = new Audio();

// Preload all tracks in memory
const preloaded = tracks.map(t => {
  const a = new Audio();
  a.src = t.src;
  a.preload = "auto";
  return a;
});

const startBtn = document.getElementById("startBtn");
const navControls = document.getElementById("navControls");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");
const trackTitle = document.getElementById("trackTitle");

// Swap tracks using two Audio objects for instant playback
function playTrack(index) {
  currentTrack = index;
  currentAudio = preloaded[currentTrack];
  trackTitle.textContent = tracks[currentTrack].title;

  // Determine next track
  let nextIndex = (currentTrack + 1) % tracks.length;
  nextAudio = preloaded[nextIndex];

  // When current ends, swap immediately
  currentAudio.onended = () => {
    currentAudio = nextAudio;
    trackTitle.textContent = tracks[(currentTrack + 1) % tracks.length].title;
    currentTrack = (currentTrack + 1) % tracks.length;

    // Prepare the next track in advance
    let subsequentIndex = (currentTrack + 1) % tracks.length;
    nextAudio = preloaded[subsequentIndex];

    currentAudio.play();
  };

  currentAudio.play();
}

// Navigation
nextBtn.addEventListener("click", () => {
  let nextIndex = (currentTrack + 1) % tracks.length;
  playTrack(nextIndex);
});
prevBtn.addEventListener("click", () => {
  let prevIndex = (currentTrack - 1 + tracks.length) % tracks.length;
  playTrack(prevIndex);
});

// Start button
startBtn.addEventListener("click", () => {
  startBtn.style.display = "none";
  navControls.style.display = "inline";
  playTrack(0);
});
</script>
</body>
</html>
